'use strict';

var react = require('react');
var CB = react.cb;
var CBV = react.cbv;

function loadMdFile(file, cb) {
  var data = file + '-data';
  setTimeout(function () { cb(null, data); }, 100); //similate file load
}

function mergeIntoHtml(data, cb) {
  var html = data + '-html';
  setTimeout(function () { cb(null, html); }, 100); //simulate templ load
}

function sendHtml(html, cb) {
  var bytes = html.length;
  setTimeout(function () { cb(null, bytes); }, 100); //simulate write
}

var loadAndSave = react(function defineFromSource(file, cb) {
  loadMdFile(file, CB);
  var data = CBV();

  mergeIntoHtml(data, CB);
  var html = CBV();

  sendHtml(html, CB);
  var bytes = CBV();

  cb(null, file, bytes);
});